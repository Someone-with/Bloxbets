<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Donate â†’ Get Points</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      max-width: 560px;
      margin: 2rem auto;
      padding: 1rem;
      background: #f8f9fc;
      color: #1a1a1a;
    }
    h1 { color: #5865F2; margin-bottom: 0.5rem; }
    p { margin: 0.5rem 0 1.5rem; }
    label { display: block; margin: 1rem 0 0.4rem; font-weight: 600; }
    input, select {
      padding: 0.8rem;
      font-size: 1rem;
      width: 100%;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    #paypal-button-container {
      margin-top: 1.5rem;
    }
    .success {
      background: #d4edda;
      color: #155724;
      padding: 1rem;
      border-radius: 6px;
      margin-top: 1.5rem;
      display: none;
      font-weight: 500;
    }
    .note {
      font-size: 0.9rem;
      color: #666;
      margin-top: 1rem;
    }
  </style>
</head>
<body>

  <h1>Support the Game!</h1>
  <p>Every $1 = 1 point in-game. Your Discord ID will be announced.</p>

  <label>Discord User ID (optional):</label>
  <input id="discordId" type="text" placeholder="123456789012345678">

  <label>Donation Amount:</label>
  <select id="amount">
    <option value="1.00">$1.00</option>
    <option value="5.00" selected>$5.00</option>
    <option value="10.00">$10.00</option>
    <option value="20.00">$20.00</option>
    <option value="50.00">$50.00</option>
  </select>

  <div id="paypal-button-container"></div>

  <div id="success" class="success">
    Donation successful! Points added in Discord.
  </div>

  <div class="note">
    <strong>Note:</strong> This site runs 100% on GitHub Pages. No backend needed.
  </div>

  <!-- PayPal SDK -->
  <script src="https://www.paypal.com/sdk/js?client-id=AUp0UM3hJPic-OtC2uaIKjs0EJLxxn0zVNZVrHs1C-GVK-5BaI0gHj10iNbgpS4fnwPuGUcqGUCGcrPy&currency=USD"></script>

  <script>
    // === HARD-CODED DISCORD WEBHOOK ===
    const DISCORD_WEBHOOK = "https://discord.com/api/webhooks/1434584171207987351/LwPIu4d10o0rwE8DUfGps4XsVXRdyMHDOf8hi-lGWt9LgjgX1t9YblPnmAjCEOiCLVz5";

    const discordIdInput = document.getElementById('discordId');
    const amountSelect   = document.getElementById('amount');
    const successDiv     = document.getElementById('success');

    // Render PayPal Button
    paypal.Buttons({
      createOrder: function(data, actions) {
        const amount = amountSelect.value;
        return actions.order.create({
          purchase_units: [{
            amount: { value: amount }
          }]
        });
      },

      onApprove: function(data, actions) {
        return actions.order.capture().then(async function(details) {
          const amount = details.purchase_units[0].amount.value;
          const discordId = discordIdInput.value.trim();
          const mention = discordId ? `<@${discordId}>` : 'Anonymous';

          const message = {
            content: `**Game deposit!**\nUser ${mention}\nPoints (${amount})`
          };

          try {
            const resp = await fetch(DISCORD_WEBHOOK, {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify(message)
            });

            if (resp.ok) {
              successDiv.style.display = 'block';
            } else {
              throw new Error('Status: ' + resp.status);
            }
          } catch (err) {
            console.error('Discord webhook failed:', err);
            alert('Payment succeeded, but Discord alert failed. Contact admin.');
          }
        });
      },

      onError: function(err) {
        console.error('PayPal error:', err);
        alert('Payment failed. Please try again.');
      }
    }).render('#paypal-button-container');
  </script>

</body>
</html>